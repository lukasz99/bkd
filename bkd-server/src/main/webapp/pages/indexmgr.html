<link rel="stylesheet" href="https://www.ncbi.nlm.nih.gov/Structure/icn3d/lib/jquery-ui.min.css">
<link rel="stylesheet" href="https://www.ncbi.nlm.nih.gov/Structure/icn3d/icn3d.css">
<script src="https://www.ncbi.nlm.nih.gov/Structure/icn3d/lib/jquery.min.js"></script>
<script src="https://www.ncbi.nlm.nih.gov/Structure/icn3d/lib/jquery-ui.min.js"></script>
<script src="https://www.ncbi.nlm.nih.gov/Structure/icn3d/lib/threeClass.min.js"></script>
<script src="https://www.ncbi.nlm.nih.gov/Structure/icn3d/icn3d.min.js"></script>

</br></br></br></br></br>
<div>
  <h1>Index Manager</h1>
  <div class="status">
    <div>Index status</div>
    <div>
      <div id="index-counts"></div>
    </div>
  </div>
  <hr/>
  <div class="manager">
    <div id="index-mgr">
      <div id="index-init">
        <div>Initialize</div>
     </div>   
      <div id="index-reindex">
        <div>Reindex</div>
     </div>   
    </div>  
  </div>    
</div>
</br></br></br></br></br></br></br></br>

<script type="text/javascript">
  $( document ).ready(function() {
     myurl ="indexmgr";          
     $.ajax( { url: myurl} )
        .done( function( data, textStatus ){             
             for(var i =0; i < data["data"]["status"].length; i ++ ){
               console.log(JSON.stringify(data["data"]["status"][i]));
               var ccnt=data["data"]["status"][i];
               var html = "<div>";                
               if( ccnt["count"] >=0 ){
                  html += ccnt["index"]+ " index: " + ccnt["count"] + " entries</div>";
                  rex = "<div>" + ccnt["index"] +
                       " <input id='reindex_"+ ccnt["index"] +"' type='button' value='GO!!!'/>" +
                       "</div>";
                  $("#index-reindex").append(rex);
                  $("#reindex_" + ccnt["index"]).on('click',function(event){
                        var index = event.currentTarget.id.replace("reindex_","");
                        var conf = confirm("Do you want to continue ?");
                        if( conf ){
                        console.log("Reindexing....");
                        $.ajax( { url: "indexmgr?op=reindex&id="+index} )
                        }
                  });

                  inx = "<div>" + ccnt["index"] +
                       " <input id='init_"+ ccnt["index"] +"' type='button' value='GO!!!'/>" +
                       "</div>";
                  $("#index-init").append(inx);
                  $("#init_" + ccnt["index"]).on('click',function(event){
                        var index = event.currentTarget.id.replace("init_","");
                        var conf = confirm("Do you want to continue ?");
                        if( conf ){
                        console.log("Reinitializing....");
                        $.ajax( { url: "indexmgr?op=init&id="+index} )
                        }
                  });

               } else{
                  html += "<div>" + ccnt["index"]+ " index:  N/A</div>";                
               }
               $("#index-counts").append(html);
             }
        });               
   });
 </script>
